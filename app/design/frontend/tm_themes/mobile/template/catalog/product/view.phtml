<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magento.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magento.com for more information.
 *
 * @category    design
 * @package     rwd_default
 * @copyright   Copyright (c) 2006-2014 X.commerce, Inc. (http://www.magento.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */

/**
 * Product view template
 *
 * @see Mage_Catalog_Block_Product_View
 * @see Mage_Review_Block_Product_View
 */
?>
<?php 
    global $_product_type_normal_image, $_product_type_large_image, $_product_type_center_image;

    /* Select type of product view (only one) */
    $_product_type_normal_image = false;
    $_product_type_large_image  = true;
    $_product_type_center_image = false;

?>
<?php 
    if( $_product_type_normal_image ){
        $grid_cols_1 = $grid_cols_2 = 'col-sm-6';
        $indicate_class = 'normal-image-type';
    }else if( $_product_type_large_image ){
        $grid_cols_1 = 'col-lg-9 col-sm-6';
        $grid_cols_2 = 'col-lg-3 col-sm-6';
        $indicate_class = 'large-image-type';
    }else if( $_product_type_center_image ){
        $grid_cols_1 = $grid_cols_2 = 'col-sm-12';
        $indicate_class = 'center-image-type';
    }

?>
<?php $_helper = $this->helper('catalog/output'); ?>
<?php $_product = $this->getProduct(); ?>
<?php
//Preparo imagenes
$media = Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_MEDIA)."/catalog/product";
$path1 = Mage::getResourceModel('catalog/product')->getAttributeRawValue($_product->getId(), 'img_cent_1_mov', Mage::app()->getStore()->getStoreId());
$path2 = Mage::getResourceModel('catalog/product')->getAttributeRawValue($_product->getId(), 'img_cent_2_mov', Mage::app()->getStore()->getStoreId());
$path3 = Mage::getResourceModel('catalog/product')->getAttributeRawValue($_product->getId(), 'imagen_tejidos_mov', Mage::app()->getStore()->getStoreId());
$path4 = Mage::getResourceModel('catalog/product')->getAttributeRawValue($_product->getId(), 'imagen_costes_mov', Mage::app()->getStore()->getStoreId());

    if($path1 != "no_selection" && $path1 != ""){
	    $img_cent_1 = $media.$path1;
    }else{
	    $img_cent_1 = "";
    }
    if($path2 != "no_selection" && $path2 != "") {
	    $img_cent_2 = $media . $path2;
    }
    else{
        $img_cent_2 = "";
    }
    if($path3 != "no_selection" && $path3 != "") {
        $img_tejidos = $media . $path3;
    }
    else{
        $img_tejidos = "";
    }
    if($path4 != "no_selection" && $path4 != "") {
        $img_costes = $media . $path4;
    }
    else{
        $img_costes = "";
    }



?>
<script type="text/javascript">
    var optionsPrice = new Product.OptionsPrice(<?php echo $this->getJsonConfig() ?>);
</script>
<script src="<?php echo $this->getSkinUrl('js/lib/elevatezoom/jquery.elevatezoom.js'); ?>"></script>
<style> .wrapper { margin-top: 25px;} #header-account{margin-top:20px;}#header-cart-mobile{margin-top:20px;}</style>
<div class="top-message">
	<h4> <?php echo $this->__('Cambios y devoluciones gratis');?> </h4>
</div>

<div id="messages_product_view"><?php //echo $this->getMessagesBlock()->toHtml() ?></div>

<div class="product-view <?php echo $indicate_class; ?>" itemscope itemtype="https://schema.org/Offer">
	<div class="product-essential row row-eq-height">
        <div class="col-lg-4 col-md-4 col-xs-12"></div>
		<div class="product-img-box col-lg-4 col-md-4 col-xs-12   <?php //echo $grid_cols_1 ?>" id="style-img">
			<div class="product-name">
				<h2><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name') ?></h2>
			</div>
			<?php echo $this->getChildHtml('media') ?>
		</div>

		<div class="col-lg-4 col-md-4 col-xs-12 lateralDerecho">
	    	<form action="<?php echo str_replace("https:","https:",$this->getSubmitUrl($_product)) ?>" method="post" id="product_addtocart_form"<?php if($_product->getOptions()): ?> enctype="multipart/form-data"<?php endif; ?>>
				<?php echo $this->getBlockHtml('formkey') ?>
				<div class="no-display">
					<input type="hidden" name="product" value="<?php echo $_product->getId() ?>" />
					<input type="hidden" name="related_product" id="related-products-field" value="" />
				</div>

				<div class="<?php //echo $grid_cols_2 ?>" id="product-info">
					<div class="row" style="margin-left: -15px; margin:right:-15px">

						<!--NOMBRE PRODUCTO-->
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 product-name secondary" itemprop="name">
							<h1><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name') ?></h1>

							<!--PRECIO-->
							<?php echo $this->getPriceHtml($_product); ?>
							<?php echo $this->getChildHtml('bundle_prices') ?>
							<?php echo $this->getTierPriceHtml() ?>
							<!--/PRECIO-->

							<!-- Aplazame -->
							<?php //echo $this->getChildHtml('extrahint') ?>

							<!--SHORT DESCRIPTION-->
							<p class="short-description">
								<?php $_description = $this->getProduct()->getShortDescription(); ?>
								<?php if ($_description): ?>
									<?php echo $this->helper('catalog/output')->productAttribute($this->getProduct(), $_description, 'description') ?> 
								<?php endif; ?>
							</p>
							<!--/SHORT DESCRIPTION-->
						</div>

                        <!--Color y tallas-->
                        <div class="row" style="margin-top: 5px; margin-left: -10px; margin-right: -10px;">
                            <div class="col-lg-12 col-md-12 col-xs-12" style="padding: 10px;">
                                <a class="btn btn-outline-dark btnsizes" data-toggle="collapse" href="#tallas" aria-expanded="false" aria-controls="collapseExample"><?php echo $this->__("Sizes") ?></a>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-xs-4 talla collapse" id="tallas" style="padding: 0;">

							<?php
							$config = $_product->getTypeInstance(true);
							if($_product->getTypeId() == 'configurable'){
								foreach($config->getConfigurableAttributesAsArray($_product) as $attributes)
								{
									?>
                                    <div class="tallas-productos">
										<?php if($_product->getStockItem() && $_product->getStockItem()->getIsInStock()): ?>
                                            <ul class="sizes">
												<?php foreach($attributes["values"] as $values)
												{
													?>
                                                    <li class="sizeInput" data-value ="<?php echo $values['value_index']?>">
														<?php echo $values["label"]?>
                                                    </li>
													<?php
												}
												?>
                                            </ul>
                                            <div id="messages_product_view"><?php echo $this->getMessagesBlock()->toHtml() ?></div>
                                            <input type="hidden" id = "super_attribute<?php echo $attributes['attribute_id'] ?>" name = "super_attribute[<?php echo $attributes['attribute_id'] ?>]" value="">
										<?php else:?>
                                            <p class="availability out-of-stock"><span><?php echo $this->__('Out of stock') ?></span></p>
										<?php endif?>
                                        <!--</span>-->
                                    </div>
									<?php
								}
							}
							?>
							<!--Llamada Modal Guia de tallas-->
						<div class="panel panel-default find-my-size" style="border:none !important;">
							<div aria-controls="collapseTwo-prod" aria-expanded="true" data-target="#collapseTwo-prod" data-parent="#accordion-prod" data-toggle="collapse" id="headingTwo-prod" role="tab" class="pan-heading-prod">
								<div class="guia-de-tallas col-lg-12 col-md-12 col-xs-12 talla">
									<a class="accordion-toggle uppercase" data-toggle="modal" data-target="#guia-de-tallas-modal"><?php echo $this->__("Find my size"); ?></a>
								</div>
							</div>
						</div>
						<!--FIN Llamada Modal Guia de tallas-->
						</div>



						<!-- ADD CARRITO -->
						<div class="add-to-cart-wrapper col-lg-12 col-md-12 col-xs-12">
							<?php echo $this->getChildHtml('other');?>
							<?php if ($_product->isSaleable()):?>
								<?php echo $this->getChildHtml('addtocart') ?>
							<?php endif;?>
						</div>
						<!-- FIN ADD CARRITO -->

						<!-- Whislist ->
						<div class="add-Whislist col-lg-12 col-md-12 col-xs-12">
							<?php /* if ($this->helper('wishlist')->isAllow()) : ?>
								<div id="productWishlist">
									<a 
									<?php 	if (Mage::getSingleton('customer/session')->isLoggedIn())
                            			{ 
                            				echo 'href="'.$this->helper('wishlist')->getAddUrl($_product).'"';
                            			}
                            			else{ 
                            				echo 'onclick="abrirLogin2()"';
                            			}
                            	?>
									
									class="link-wishlist">
										<span><?php echo $this->__('Save for later') ?></span>
									</a>
								</div>
							<?php endif; */ ?>
						</div>
						<!--/ FIN Whislist-->

                        <!-- Medidas modelo -->
						<?php $_medidas_modelo = $this->getProduct()->getMedidasModelo(); ?>
						<?php if ($_description): ?>
                            <div class="col-lg-12 col-md-12 col-xs-12" style="padding: 0">
                                <div id="medidasModelo">
                                    <span class="details"><?php echo $this->__("Details") ?>:</span>
                                    <p class="medidas-modelo"><?php echo $this->helper('catalog/output')->productAttribute($this->getProduct(), $this->getProduct()->getMedidasModelo()); ?>
                                        <a class="accordion-toggle uppercase" data-toggle="modal" data-target="#modal-cuidados"><span class="cuidado"><?php echo $this->__("Cuidado del producto") ?></span></a>
                                        <span class="envios"><?php echo $this->__("Envíos y devoluciones gratuitas en Península") ?></span>
                                    </p>
                                </div>
                            </div>
						<?php endif;?>
                        <!--/ FIN Medidas modelo-->




					</div>

				</div>
			</form>
			

			<?php if ($_product->isSaleable() && $this->hasOptions()):?>
				<?php echo $this->getChildChildHtml('container2', '', true, true) ?>
			<?php endif;?>

		           <!-- <div class="col-lg-1 col-md-1 col-xs-1"></div>-->
		</div>
	</div> <!-- Cierre product info -->

    <div class="row composicion">
        <h1> <?php echo $this->getProduct()->getTejido(); ?></h1>
    </div>

    <div class="row imgs-centrales">
        <div class="col-md-6 col-xs-6" style="padding-right: 0;">
	        <?php if($img_cent_1 != ""):?>
                <img src="<?php echo $img_cent_1; ?>" class="img-properties" style="width:100%;"/>
	        <?php endif;?>
        </div>
        <div class="col-md-6 col-xs-6" style="padding-left: 0;">
            <?php if($img_cent_2 != ""):?>
            <img src="<?php echo $img_cent_2; ?>" class="img-properties" style="width:100%;"/>
            <?php endif;?>
        </div>
    </div>

    <div class="row beneficios">
        <div class="col-lg-12 col-md-12 col-xs-12">
            <div class=" col-lg-12 col-md-12 col-xs-12" style="padding: 0;">
			    <?php $_composicion = $this->getProduct()->getComposicion(); ?>
			    <?php if ($_composicion): ?>
                    <div class="std">
					    <?php echo $this->helper('catalog/output')->productAttribute($this->getProduct(), $_composicion, 'composicion') ?>
                    </div>
			    <?php endif; ?>
            </div>
        </div>
    </div>

    <div class="row imgs-centrales">
        <div class="col-md-12 col-xs-12">
			<?php if($img_tejidos != ""):?>
				<h1 id="texto_tejidos"><?php echo Mage::getResourceModel('catalog/product')->getAttributeRawValue($_product->getId(), 'texto_tejidos', Mage::app()->getStore()->getStoreId()); ?></h1>
                <img src="<?php echo $img_tejidos; ?>" class="img-properties" style="width:100%;"/>
			<?php endif;?>
        </div>
    </div>
    <div class="row imgs-centrales img-costes">
        <div class="col-md-12 col-xs-12">
			<?php if($img_costes != ""):?>
                <img src="<?php echo $img_costes; ?>" class="img-properties" style="width:100%;"/>
			<?php endif;?>
        </div>
    </div>


    <script type="text/javascript">
        //<![CDATA[
            var productAddToCartForm = new VarienForm('product_addtocart_form');
            productAddToCartForm.submit = function(button, url) {
                if (this.validator.validate()) {
                    var form = this.form;
                    var oldUrl = form.action;
                    if (url) {
                       form.action = url;
                    }
                    var e = null;
                    try {
                        this.form.submit();
                    } catch (e) {
                    }
                    this.form.action = oldUrl;
                    if (e) {
                        throw e;
                    }

                    if (button && button != 'undefined') {
                        button.disabled = true;
                    }
                }
            }.bind(productAddToCartForm);

            productAddToCartForm.submitLight = function(button, url){
                if(this.validator) {
                    var nv = Validation.methods;
                    delete Validation.methods['required-entry'];
                    delete Validation.methods['validate-one-required'];
                    delete Validation.methods['validate-one-required-by-name'];
                    // Remove custom datetime validators
                    for (var methodName in Validation.methods) {
                        if (methodName.match(/^validate-datetime-.*/i)) {
                            delete Validation.methods[methodName];
                        }
                    }

                    if (this.validator.validate()) {
                        if (url) {
                            this.form.action = url;
                        }
                        this.form.submit();
                    }
                    Object.extend(Validation.methods, nv);
                }
            }.bind(productAddToCartForm);
        //]]>

        /* Selector de tallas*/
        	jQuery(document).ready(function(){
        		jQuery(".sizes li").click(function(){
        			jQuery(this).parent().find(".selected").removeClass("selected");
        			jQuery(this).addClass("selected");
        			//Asigno talla
        			jQuery("#super_attribute135").val(jQuery(this).attr("data-value"));
        		});
        	});
        /* FIN Selector de tallas*/
        </script>

        <!-- COMPARTIR EN REDES SOCIALES-->
        <!-- <div class="clear"></div>
        <div class="prod_socials"><?php //echo $this->getChildHtml('alert_urls') ?></div> 
        -->

    </div>

    
        
    </div>
	<div class="related-products">
    	<?php echo $this->getChildHtml('related_products') ?>
    </div>   
    <?php echo $this->getChildHtml('upsell_products') ?>
    <?php echo $this->getChildHtml('product_additional_data') ?>

	<!-- modal window - GUIA DE TALLAS -->
	<div id="guia-de-tallas-modal" class="modal fade  col-lg-12 col-md-12 col-sm-12 col-xs-12 col-xxs-12">
		<div class="modal-dialog modal-dialog-guia-tallas">
			<div class="modal-content modal-content-guia-tallas ">
				<div class="modal-header guia-de-tallas-modal-header">
					<a class="btn btn-close" data-dismiss="modal" style="float:right; padding: 0 !important;">
						<button type="button" class="close guia-de-tallas-modal-close" aria-label="Close">
							<span aria-hidden="true" style="font-size: 40px">&times;</span>
						</button>
					</a>
					<h4 class="modal-title uppercase modal-title-guia-de-tallas"><?php echo Mage::helper('catalog')->__('Find your size'); ?></h4>
				</div>

				<div class="modal-body">
				<!--INICIO STEPERS-->
					<div class="container">

						<div class="row bs-wizard" style="border-bottom:0;">

							<div id="guia-tallas-1" class="bs-wizard-step active" style="width:20%; float:left;">
								<div id="stepnum-1" class="text-center bs-wizard-stepnum active">Measuring guide</div>
								<div class="progress">
									<div class="progress-bar"></div>
								</div>
								<a href="#" class="bs-wizard-dot"></a>
							</div>

							<div id="guia-tallas-2" class="bs-wizard-step disabled" style="width:20%; float:left;">
								<div id="stepnum-2" class="text-center bs-wizard-stepnum disabled">Body Length</div>
								<div class="progress">
									<div class="progress-bar"></div>
								</div>
								<a href="#" class="bs-wizard-dot"></a>
							</div>

							<div id="guia-tallas-3" class="bs-wizard-step disabled"  style="width:20%; float:left;"><!-- complete -->
								<div id="stepnum-3" class="text-center bs-wizard-stepnum disabled">Chest width</div>
								<div class="progress">
									<div class="progress-bar"></div>
								</div>
								<a href="#" class="bs-wizard-dot"></a>
							</div>

							<div id="guia-tallas-4" class="bs-wizard-step disabled"  style="width:20%; float:left;"><!-- active -->
								<div id="stepnum-4" class="text-center bs-wizard-stepnum disabled">Bottom width</div>
								<div class="progress">
									<div class="progress-bar"></div>
								</div>
								<a href="#" class="bs-wizard-dot"></a>
							</div>

							<div id="guia-tallas-5" class="bs-wizard-step disabled" style="width:20%; float:left;"><!-- active -->
								<div id="stepnum-5" class="text-center bs-wizard-stepnum disabled">Sleevelength</div>
								<div class="progress">
									<div class="progress-bar"></div>
								</div>
								<a href="#" class="bs-wizard-dot"></a>
							</div>

						</div>
						<div id="guia-tallas-body-1" class="row guia-tallas-body">
							<?php if(Mage::registry('current_category')->getId() != 4):?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/hombre/guia_tallas_man_1".".jpg' style='width:100%;margin:0 auto;'/>"; ?>
							<?php else: ?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/mujer/guia_tallas_woman_1".".jpg' style='width:100%;margin:0 auto;'/>"; ?>
							<?php endif;?>
						</div>

						<div id="guia-tallas-body-2" class="row guia-tallas-body" style="display:none;">
							<?php if(Mage::registry('current_category')->getId() != 4):?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/hombre/guia_tallas_man_2".".jpg' style='width:100%;'/>"; ?>
							<?php else: ?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/mujer/guia_tallas_woman_2".".jpg' style='width:100%;'/>"; ?>
							<?php endif;?>

						</div>

						<div id="guia-tallas-body-3" class="row guia-tallas-body" style="display:none;">
							<?php if(Mage::registry('current_category')->getId() != 4):?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/hombre/guia_tallas_man_3".".jpg' style='width:100%;'/>"; ?>
							<?php else: ?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/mujer/guia_tallas_woman_3".".jpg' style='width:100%;'/>"; ?>
							<?php endif;?>

						</div>

						<div id="guia-tallas-body-4" class="row guia-tallas-body" style="display:none;">
							<?php if(Mage::registry('current_category')->getId() != 4):?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/hombre/guia_tallas_man_4".".jpg' style='width:100%;'/>"; ?>
							<?php else: ?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/mujer/guia_tallas_woman_4".".jpg' style='width:100%;'/>"; ?>
							<?php endif;?>

						</div>

						<div id="guia-tallas-body-5" class="row guia-tallas-body" style="display:none;">
							<?php if(Mage::registry('current_category')->getId() != 4):?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/hombre/guia_tallas_man_5".".jpg' style='width:100%;'/>"; ?>
							<?php else: ?>
								<?php echo "<img src='".Mage::getBaseUrl('media')."wysiwyg/guia_tallas/mujer/guia_tallas_woman_5".".jpg' style='width:100%;'/>"; ?>
							<?php endif;?>

						</div>
					</div>
				<!--FIN STEPERS-->
				</div>
				<div class="modal-footer modal-footer-guia-de-tallas">
					<div class="row">
						<p><?php echo Mage::helper('catalog')->__('IMPORTANTE: Te recomendamos que midas una hoodie que tengas por casa y lo midas sobre una mesa y no con ella puesta.'); ?></p>
					</div>
				</div>      
			</div>
		</div>

	</div>
	<!-- /.modal - DISPONIBILIDAD EN TIENDAS -->

<div id="modal-cuidados" class="modal fade  col-lg-12 col-md-12 col-sm-12 col-xs-12 col-xxs-12">
    <div class="modal-dialog modal-dialog-guia-tallas">
        <div class="col-md-4 col-xs-12"></div>
        <div class="modal-content modal-content-guia-tallas col-md-4 col-xs-12">
            <div class="modal-header modal-cuidados-header">
                <a class="btn btn-close" data-dismiss="modal" style="float:right; padding: 0 !important;">
                    <button type="button" class="close modal-cuidados-close" aria-label="Close">
                        <span aria-hidden="true" style="font-size: 40px">&times;</span>
                    </button>
                </a>
                <h4 class="modal-title uppercase modal-title-cuidados"><?php echo Mage::helper('catalog')->__('Cuidado del producto'); ?></h4>
            </div>

            <div class="modal-body">
                <div class="container">
	                <?php $_cuidadoproducto = $this->getProduct()->getCuidadoproducto(); ?>
	                <?php if ($_cuidadoproducto): ?>
                        <div class="std">
			                <?php echo $this->helper('catalog/output')->productAttribute($this->getProduct(), $_cuidadoproducto, 'cuidadoproducto') ?>
                        </div>
	                <?php endif; ?>

                </div>

            </div>
        </div>
        <div class="col-md-4 col-xs-12"></div>
    </div>

</div>
</div>
